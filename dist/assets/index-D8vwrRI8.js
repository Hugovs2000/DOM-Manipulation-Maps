(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();let a=L.map("map"),s=L.layerGroup(),m=L.circle(),d=L.layerGroup(),f=[];function b(e,t){a=a.setView([e,t],18),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:1,maxZoom:20,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(a)}function C(e,t){f.push([e,t])}function w(){let e=L.polyline(f,{color:"purple"});d.addLayer(e),d.addTo(a)}function $(e,t){m=L.circle([e,t],{color:"rgb(46, 120, 240)",fillColor:"rgb(46, 120, 240)",fillOpacity:1,radius:3}),s.addLayer(m),s.addTo(a)}function E(){s.clearLayers(),d.clearLayers()}function v(){f=[]}function R(e,t){fetch("https://go-kart-api.onrender.com/runs").then(r=>r.json()).then(r=>{if(!r)throw new Error("Cannot find Run");e(r)}).catch(r=>t(r)).finally(()=>console.log("Got all the Runs"))}function M(e,t,r){fetch(`https://go-kart-api.onrender.com/runs/${e}/`).then(o=>o.json()).then(o=>{if(!(o!=null&&o.lapSummaries))throw new Error("Cannot find Laps for Run");t(o)}).catch(o=>r(o)).finally(()=>console.log("Got all the Laps per Run"))}function P(e,t,r,o){fetch(`https://go-kart-api.onrender.com/runs/${e}/laps/${t}`).then(n=>n.json()).then(n=>{r(n)}).catch(n=>o(n)).finally(()=>console.log(`Got Lap: ${t}`))}const h=document.getElementById("heading"),G=document.getElementById("select-button");function I(e,t){e.id=`${t}`,e.textContent=`${t}`,G.appendChild(e)}function T(e,t){h.id="details",h.innerHTML=`${e.trackName}:<br />${e.driver} - Lap : ${t}`}let u,c=0,g;function k(){b(-29.697911,30.525229)}function y(){clearInterval(g)}const A=e=>{let t=0;g=setInterval(()=>{var n,i,l,p;if(!((i=(n=e==null?void 0:e.dataSet)==null?void 0:n[t])!=null&&i["Lat."]||(p=(l=e==null?void 0:e.dataSet)==null?void 0:l[t])!=null&&p["Lon."]))throw new Error("Cannot find coordinates");let r=e.dataSet[t]["Lon."]*1e-6,o=e.dataSet[t]["Lat."]*1e-6;E(),$(o,r),C(o,r),w(),t<e.dataSet.length-1?t+=1:y()},20)},j=e=>{let t=1;for(let r in e.lapSummaries){const o=document.createElement("button");I(o,t),o.addEventListener("click",function(){v(),y(),c=o.id,P(u,c,A,i=>console.error(i)),T(e,c)}),t+=1}},x=e=>{u=e[0],M(u,j,t=>console.error(t))};function z(){R(x,e=>console.error(e))}k();z();
